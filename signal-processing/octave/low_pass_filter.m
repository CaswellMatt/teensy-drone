 sf = 1000; sf2 = sf/2;
 
d = [0.4469
0.5203
-0.24311
0.27562
-0.23822
0.4836
-0.04981
0.46892
0.01381
0.54477
-0.50492
0.36615
-0.70801
0.65977
-0.84014
0.65732
-0.3679
0.46647
0.27317
-0.20396
0.39307
-0.2113
0.50073
-0.11343
0.45913
0.00647
0.4469
-0.11343
0.25115
-0.47311
0.42977
-0.85972
0.53009
-0.69822
0.67935
-0.50003
0.37839
0.07498
0.03827
0.29275
-0.19417
0.60839
-0.2113
0.43466
0.03827
0.43222
-0.07917
0.18753
-0.25535
0.34658
-0.3679
0.38817
-0.68599
0.76009
-0.6811
0.41019
-0.47067
0.38573
-0.19662
0.19243
0.30743
-0.12811
0.47626
-0.24801
0.42488
-0.20396
0.39062
-0.12811
0.33434
0.06764
0.46647
-0.12811
0.48115
-0.60524
0.39062
-0.73003
0.57658
-0.59056
0.69403
-0.11098
0.19243
0.27072
0.03093
0.62307
-0.24801
0.50317
-0.13056
0.44445
0.06274
0.45179
-0.08651
0.25115
-0.17705
0.34902
-0.61258
0.34902
-0.62237
0.59371
-0.55875
0.6402
-0.4095
0.12881
-0.0229
0.15083
0.26828
-0.1746
0.39796
-0.15013
0.56924
-0.14279
0.39551
-0.17705
0.24136
0.01136
0.40775
-0.25535
0.40041
-0.47311
0.38573
-0.74471
0.62796
-0.60769
0.31232
-0.26758
0.51786
0.26094
-0.0229
0.41509
-0.1746
0.60105
-0.12077
0.51296
-0.07183
0.42977
0.0554
0.39062
-0.11832
0.37839
-0.4829
0.31477
-0.5979
0.60349
-0.63216
0.54722
-0.48046
0.50073
-0.0963
-0.04247
0.20955
-0.06694
0.42488
-0.25045
0.56924
-0.133
0.32945
0.02849
0.38573
-0.23577
0.24626
-0.24556
0.3319
-0.28716
0.45424
-0.61748
0.5252
-0.67376
0.55211
-0.46088
0.30743
-0.12077
0.19977
0.29275
-0.10854
0.44934
-0.21864
0.43466
-0.15258
0.51541
-0.06205
0.37104
-0.01556
0.43466
-0.04736
0.50073
-0.49514
0.51296
-0.73982
0.45424
-0.58322
0.66222
-0.22843
0.38083
0.00402
-0.03513
0.42977
-0.17705
0.47626
-0.09875
0.57658
-0.06205
0.32211
-0.1012
0.3637
-0.23822
0.30743
-0.38992
0.32211
-0.51716
0.50807
-0.63216
0.56435
-0.63461
0.35392
-0.37279
0.21934
0.15083
-0.05471
0.3637
0.01136
0.60105
-0.23822
0.37104
-0.27247
0.3686
-0.02534
0.38328
-0.04492
0.4469
-0.20886
0.47626
-0.51226
0.65977
-0.76918
0.35147
-0.46577
0.62796
0.00891
0.1704
0.18264
-0.08651
0.45668
-0.23577
0.53988
-0.14279
0.40285
0.06519
0.45668
-0.03024
0.38328
-0.26513
0.29275
-0.56609
0.45179
-0.54897
0.43956
-0.63216
0.59615
-0.4878
0.25604
-0.14034
-0.05471
0.11902
0.02849
0.46892
-0.19173
0.49094
-0.20641
0.48605
-0.18683
0.28051
-0.02045
0.3637
0.00647
0.49828
-0.41194
0.59371
-0.63216
0.52764
-0.57588
0.51786
-0.36301
0.37104
0.04806
0.26338
0.46158
-0.16971
0.51541
-0.26269
0.53988
-0.03024
0.5203
0.0554
0.31477
-0.0596
0.40285
-0.35811
0.35147
-0.66397
0.42732
-0.53184
0.57413
-0.49758
0.4469
-0.45354
0.35636
0.08966
-0.30184
0.18998
-0.08407
0.47381
-0.11588
0.4469
-0.2945
0.41509
-0.17705
0.28296
0.02359
0.42243
-0.08896
0.39796
-0.49514
0.61818
-0.64929
0.46402
-0.52205
0.56679
-0.24311
0.1704
-0.06939
0.30009
0.50807
-0.30673
0.51541
-0.2945
0.47137
-0.00577
0.51541
0.23402
0.46402
-0.1746
0.35636
-0.23822
0.42488
-0.66642
0.37839
-0.58078
0.54232
-0.60035
0.5619
-0.30918
0.11413
0.01625
-0.17949
0.31966
-0.2113
0.33679
0.02849
0.7185
-0.16237
0.31721
-0.19417
0.33434
-0.12811
0.27072
-0.22109
0.45424
-0.50248
0.50562
-0.69088
0.4836
-0.51716
0.42977
-0.20396
0.35636
0.1753
0.06519
0.3319
-0.20886
0.65243
-0.2945
0.43222
-0.08162
0.51541
0.3686
0.50317
-0.11343
0.44934
-0.43152
0.37104
-0.70801
0.51786
-0.58078
0.5252
-0.51716
0.54232
-0.02534
-0.04247
0.07498
-0.07183
0.51051
-0.28226
0.32945
-0.05471
0.53988
-0.05471
0.38817
-0.20152
0.3686
-0.14034
0.28785
-0.34833
0.52764
-0.65173
0.52764
-0.57588
0.55456
-0.43641
0.15817
-0.14034
0.212
0.27072
-0.04736
0.39796
-0.16971
0.63775
-0.12811
0.54232
-0.11098
0.26583
0.17285
0.46402
-0.20641
0.47381
-0.66397
0.34413
-0.68354
0.5252
-0.57099
0.51541
-0.29939
0.48605
0.14104
0.06274
0.46158
-0.21375
0.42243
-0.14524
0.49583
-0.09385
0.33679
-0.03268
0.50317
-0.16726
0.31477
-0.26269
0.327
-0.56609
0.49339
-0.77652
0.51786
-0.56365
0.25604
-0.2896
0.18998
0.04072
0.01136
0.26338
-0.01311
0.60839
-0.15013
0.48605
-0.24556
0.41019
0.13125
0.39307
-0.0963
0.45179
-0.31162
0.60105
-0.65173
0.47626
-0.65663
0.37594
-0.48535
0.64509
-0.06694
0.1704
0.16062
-0.06694
0.69647
-0.23088
0.37839
-0.14769
0.45179
0.03827
0.42243
-0.06449
0.42243
-0.19173
0.31477
-0.60035
0.48849
-0.59546
0.39062
-0.68844
0.78211
-0.43397
-0.0596
-0.12322
0.16062
0.21689
-0.18928]

 
 data=[[1;zeros(sf-1,1)],sinetone(20,sf,1,1),sinetone(50,sf,1,1)];
 order=1;
 [b, a]=ellip(2, 1, 50, 0.05);
 #[.1 .2]
 filtered = filter(b,a,data);
 
 output = filter(b,a,d);
 
 disp(b)
 disp(a)
 
 clf
 subplot ( 5, 1, 1)
 plot(filtered(:,1),";1 response;")
 subplot ( 5, 1, 2 )
 plot(filtered(:,2),";2 response;")
 subplot ( 5, 1, 3 )
 plot(filtered(:,3),";3 response;")
 subplot ( 5, 1, 4 )
 plot(output,";4 response;")
 subplot (5, 1, 5)
 plot(d,";5 response;")