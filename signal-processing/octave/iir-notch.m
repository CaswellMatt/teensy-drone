d = [

-0.19258,
0.1219,
0.41084,
0.6322,
0.75405,
0.75352,
0.63805,
0.42946,
0.15489,
-0.14948,
-0.43735,
-0.67041,
-0.81994,
-0.84442,
-0.73799,
-0.52781,
-0.25696,
0.0357,
0.30867,
0.5311,
0.68222,
0.73915,
0.67583,
0.4997,
0.24854,
-0.03933,
-0.31762,
-0.54377,
-0.68904,
-0.73959,
-0.67467,
-0.51025,
-0.27186,
0.01388,
0.30761,
0.55717,
0.72904,
0.79556,
0.74128,
0.57952,
0.34539,
0.06922,
-0.21599,
-0.46236,
-0.64168,
-0.73108,
-0.71352,
-0.58315,
-0.3703,
-0.10584,
0.17298,
0.43159,
0.63965,
0.76097,
0.76523,
0.65827,
0.46032,
0.20544,
-0.07817,
-0.34849,
-0.56612,
-0.70287,
-0.73001,
-0.63955,
-0.4597,
-0.22557,
0.02985,
0.27515,
0.49385,
0.65295,
0.71095,
0.65242,
0.49278,
0.26717,
0.01441,
-0.23089,
-0.43362,
-0.57623,
-0.65019,
-0.63157,
-0.5028,
-0.299,
-0.06115,
0.19054,
0.40765,
0.5577,
0.63486,
0.62049,
0.50662,
0.3257,
0.10753,
-0.12234,
-0.33838,
-0.51344,
-0.61188,
-0.61135,
-0.51717,
-0.34795,
-0.13511,
0.08891,
0.30654,
0.49917,
0.62581,
0.6471,
0.56143,
0.40126,
0.20119,
-0.0074,
-0.20482,
-0.38361,
-0.51983,
-0.57996,
-0.54324,
-0.4166,
-0.22397,
-0.01166,
0.19161,
0.36508,
0.49598,
0.55717,
0.53003,
0.42201,
0.25653,
0.05166,
-0.16171,
-0.35434,
-0.50599,
-0.59113,
-0.59326,
-0.50972,
-0.36126,
-0.17076,
0.04102,
0.25493,
0.43106,
0.53961,
0.57047,
0.50768,
0.37199,
0.19959,
0.00218,
-0.19737,
-0.37456,
-0.50227,
-0.55282,
-0.51504,
-0.4001,
-0.23036,
-0.03135,
0.17086,
0.35443,
0.49385,
0.55451,
0.52418,
0.42201,
0.27728,
0.0953,
-0.10265,
-0.29261,
-0.4464,
-0.52674,
-0.51717,
-0.42351,
-0.27612,
-0.10691,
0.07241,
0.25014,
0.39168,
0.46245,
0.45447,
0.36721,
0.21342,
0.03676,
-0.13883,
-0.31124,
-0.44746,
-0.52196,
-0.52249,
-0.45597,
-0.33625,
-0.1814,
-0.01326,
0.15862,
0.3108,
0.41456,
0.44436,
0.39541,
0.29324,
0.16341,
0.01867,
-0.12606,
-0.25643,
-0.34849,
-0.36924,
-0.33039,
-0.2543,
-0.13564,
0.01016,
0.1666,
0.31772,
0.4284,
0.47043,
0.44649,
0.37412,
0.26131,
0.13414,
-0.01272,
-0.16863,
-0.30166,
-0.38573,
-0.40436,
-0.35434,
-0.25803,
-0.13298,
0.0192,
0.17618,
0.30867,
0.38743,
0.40499,
0.36667,
0.28207,
0.16021,
0.01388,
-0.1532,
-0.30858,
-0.4166,
-0.45757,
-0.42724,
-0.34902,
-0.23089,
-0.08083,
0.08146,
0.23258,
0.34698,
0.39275,
0.37998,
0.33421,
0.24429,
0.10966,
-0.04571,
-0.20801,
-0.34317,
-0.41766,
-0.41926,
-0.36285,
-0.25856,
-0.1117,
0.06337,
0.23631,
0.3704,
0.44383,
0.44968,
0.40286,
0.3124,
0.18097,
0.01229,
-0.16916,
-0.3288,
-0.43309,
-0.46342,
-0.42298,
-0.33518,
-0.21227,
-0.06753,
0.08891,
0.24269,
0.36082,
0.42042,
0.42893,
0.37891,
0.27196,
0.13574,
-0.01858,
-0.18034,
-0.31071,
-0.39744,
-0.44214,
-0.42298,
-0.3437,
-0.22504,
-0.06753,
0.09317,
0.22194,
0.31719,
0.35816,
0.34858,
0.30654,
0.21662,
0.08252,
-0.0537,
-0.17502,
-0.27505,
-0.32614,
-0.33731,
-0.31603,
-0.25377,
-0.14416,
0.00324,
0.14904,
0.25865,
0.3273,
0.34379,
0.30335,
0.22141,
0.107,
-0.02709,
-0.15639,
-0.26335,
-0.33359,
-0.35434,
-0.32561,
-0.24366,
-0.1117,
0.04368,
0.19853,
0.3257,
0.41084,
0.44064,
0.40392,
0.3108,
0.16766,
-0.00687,
-0.1681,
-0.29687,
-0.3852,
-0.42777,
-0.42032,
-0.36179,
-0.25271,
-0.09094,
0.09104,
0.26078,
0.38796,
0.4582,
0.455,
0.3986,
0.28898,
0.13467,
-0.0388,
-0.20801,
-0.35753,
-0.46236,
-0.51131,
-0.49003,
-0.39212,
-0.23461,
-0.05742,
0.11764,
0.27142,
0.38104,
0.43744,
0.43638,
0.37093,
0.24588,
0.08252,
-0.09839,
-0.27825,
-0.42458,
-0.50493,
-0.51184,
-0.44214,
-0.30432,
-0.13564,
0.03942,
0.21502,
0.43159,
0.48108,
0.53748,
0.47097,
0.33794,
0.16553,
-0.01592,
-0.18247,
-0.32561,
-0.43203,
-0.47513,
-0.44693,
-0.34583,
-0.18885,
-0.00155,
0.18203,
0.34166,
0.45607,
0.50555,
0.48001,
0.36933,
0.20119,
0.0075,
-0.19737,
-0.38041,
-0.49482,
-0.53366,
-0.50333,
-0.39638,
-0.24153,
-0.06806,
0.12403,
0.3124,
0.45766,
0.53269,
0.5162,
0.41243,
0.25014,
0.06443,
-0.12819,
-0.30751,
-0.45118,
-0.53366,
-0.53632,
-0.44533,
-0.28463,
-0.07498,
0.1517,
0.36401,
0.54546,
0.65774,
0.67264,
0.59335,
0.43053,
0.21396,
-0.01379,
-0.23994,
-0.44586,
-0.60018,
-0.68106,
-0.66563,
-0.54803,
-0.35913,
-0.12181,
0.12137,
0.32517,
0.48267,
0.57899,
0.5859,
0.51088,
0.36295,
0.15596,
-0.07445,
-0.30219,
-0.48684,
-0.60124,
-0.63263,
-0.57836,
-0.45384,
-0.2708,
-0.0521,
0.165,
0.34592,
0.46299,
0.49385,
0.43372,
0.30176,
0.11711,
-0.08615,
-0.28357,
-0.44852,
-0.55335,
-0.57783,
-0.52196,
-0.3868,
-0.18885,
0.04421,
0.27941,
0.48267,
0.62049,
0.66572,
0.61889,
0.48959,
0.30122,
0.07348,
-0.16704,
-0.38946,
-0.54058,
-0.60656,
-0.5757,
-0.44852,
-0.25537,
-0.02337,
0.22513,
0.44543,
0.60772,
0.69286,
0.67636,
0.56888,
0.39009,
0.16021,
-0.09201,
-0.33891,
-0.53473,
-0.63849,
-0.63849,
-0.54324,
-0.3719,
-0.14894,
0.09317,
0.31985,
0.50662,
0.61889,
0.62741,
0.5444,
0.38955,
0.18043,
-0.0521,
-0.28038,
-0.47779,
-0.60071,
-0.64328,
-0.59964,
-0.4714,
-0.28676,
-0.05742,
0.19161,


]

#sf   = 1000; sf2 = sf/2;
#n    = 9;
#f    = 80;
#Rp   = 10;
#Rs   = 30;
#side = 40;

sf     = 1024; sf2 = sf/2;
nNotch = 3;
f      = 60;
Rp     = 1;
Rs     = 20;
side   = 20;
lowerBound = f - side;
upperBound = f + side;
Wn = [lowerBound, upperBound]/sf2;

f2      = 120;
Rp2     = 4;
Rs2     = 20;
side2   = 10;
lowerBound2 = f2 - side2;
upperBound2 = f2 + side2;
Wn2 = [lowerBound2, upperBound2]/sf2;

filterType = 'stop';

% Transfer function design

[b,a] = ellip(nNotch, Rp, Rs, Wn, filterType);
#[b,a] = ellip(4,1,20,f/sf2);

#[b2,a2] = ellip(nNotch, Rp2, Rs2, Wn2, filterType);
[b2,a2] = ellip(4,Rp2,Rs2,f2/sf2);

output  = filter(b,a,d);
output2 = filter(b2,a2,output);
[h, w]   = freqz(b, a, length(d));
[h2, w2] = freqz(b2, a2, length(d));
impulseResponse=filter(b2,a2,filter(b,a,[1;zeros(sf-1,1)]))

disp(b)
disp(a)

disp(b2)
disp(a2)

#disp(output2)

 clf
 subplot ( 5, 1, 1 )
 plot(d, ";raw data;")
 ylim([-1 1])
 subplot ( 5, 1, 2 )
 plot(output,";low pass;")
 ylim([-1 1])
 subplot ( 5, 1, 3 ) 
 plot(output2, ";low pass and notch;")
 ylim([-1 1])
 subplot ( 5, 1, 4 )
 plot(w/pi,20*log10(abs(h)),";freq response notch;")
 subplot ( 5, 1, 5 )
 plot(impulseResponse,";impulse response;")
 ylim([-0.3 0.3])